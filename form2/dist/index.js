!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("form2",[],t):"object"==typeof exports?exports.form2=t():e.form2=t()}(this,function(){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.formField=t.form=void 0;var r=a(1),o=n(r),u=a(3),i=n(u);t.form=o,t.formField=i},function(e,t,a){"use strict";function n(e){var t=e.main,a=e.get,n=e.elm,o=e.emit,u=e.update,i=e.msg,c=a("form-field");t(function(e){return[l,f]});var l=function(e){var t=e.on;t("form-field:change",s),t("submit",v)},f=function(e){var t=e.expose;t({validate:s,setFields:d})},d=function(e){for(var t in e)c("set",t,e[t],e);i.set(function(t){return t.data=Object.assign({},t.data,e)})},s=function(){var e=!0,t={};c("map",function(a){var n=a.elm,r=a.state;n.querySelector("[data-rules]")&&!r.isValid&&(e=!1);var o=n.querySelector("input, select, textarea");"checkbox"==o.type||"radio"==o.type?t[o.name]=o.form[o.name].value:t[o.name]=o.value}),e!=i.getState().isValid&&(i.set(function(a){a.isValid=e,a.data=Object.assign(a.data,t)}),o("form:"+(e?"valid":"invalid"),(0,r.getFormData)(n)))},v=function(e){var t=i.getState(),a=t.isValid;a&&o("form:submit",(0,r.getFormData)(n)),e.preventDefault()};u(function(e){e&&e.data&&JSON.stringify(e.data)!=JSON.stringify(i.getState().data)&&i.set(function(t){return t.data=Object.assign({},t.data,e.data)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.model=void 0,t.default=n;var r=a(2);t.model={isValid:!1,data:{}}},function(e,t){"use strict";function a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Object.defineProperty(t,"__esModule",{value:!0});t.getRules=function(e){var t=new Function("return "+e.dataset.rules)(),a=t?t:null,n=e.type&&"checkbox"==e.type,r=n?e.checked?e.value:"":e.form[e.name].value;return{value:r,rules:a}},t.formatError=function(e){var t=Object.keys(e),n=t[0];return a({},n,!0)},t.debounce=function(e,t){var a=void 0;return function(){var n=this,r=arguments;clearTimeout(a),a=setTimeout(function(){return e.apply(n,r)},t)}},t.getFormData=function(e){var t=Array.from(e.elements).reduce(function(e,t){if(t.name){var a=(new Function("return "+t.dataset.rules)(),t.type&&"checkbox"==t.type),n=t.type&&"file"==t.type;e[t.name]=t.form[t.name].value,a&&(e[t.name]=t.checked?t.value:""),n&&t.value&&(e[t.name]=t.files)}return e},{});return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e){var t=e.main,a=e.elm,n=e.msg,o=e.injection,u=e.emit,f=e.trigger,d=e.update,s=o.validators;t(function(e){return[v,p,m]});var v=function(e){var t=e.on;t("input",l.VALIDATE_INPUT,(0,c.debounce)(g,100)),t("change",l.VALIDATE_SELECTABLE,g),t("blur",l.INPUT+", "+l.SELECTABLE,b),t("focus",l.INPUT+", "+l.SELECTABLE,x)},p=function(e){var t=e.expose;t({map:k,set:y})},m=function(){var e=a.querySelector("[data-rules]");e&&(0,i.default)(r({},e.name,(0,c.getRules)(e)),s).catch(function(e){return n.set(function(e){return e.isValid=!1})}).finally(h)},y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.querySelector("[name="+e+"]");o&&(n.set(function(e){e.value=t,e.data=r,e.touched=!0}),setTimeout(function(t){f("input","[name="+e+"]"),f("change","[name="+e+"]")}))},g=function(e){var t=e.target,a=t.name,o=t.value;"checkbox"==e.target.type||"radio"==e.target.type;(0,i.default)(r({},a,(0,c.getRules)(e.target)),s).then(function(t){n.set(function(t){t.error=null,t.isValid=!0,"checkbox"==e.target.type?t.value=e.target.checked?o:"":"radio"==e.target.type?t.value=e.target.form[a].value:t.value=o})}).catch(function(t){return n.set(function(t){t.isValid=!1,"checkbox"==e.target.type?t.value=e.target.checked?o:"":"radio"==e.target.type?t.value=e.target.form[a].value:t.value=o})}).finally(h)},b=function(e){var t=e.target,a=t.name,o=t.value;"checkbox"==e.target.type||"radio"==e.target.type;(0,i.default)(r({},a,(0,c.getRules)(e.target)),s).then(function(t){n.set(function(t){t.error=null,t.isValid=!0,t.focus=!1,"checkbox"==e.target.type?t.value=e.target.checked?o:"":"radio"==e.target.type?t.value=e.target.form[a].value:t.value=o})}).catch(function(t){n.set(function(n){n.error=(0,c.formatError)(t[a]),n.isValid=!1,n.focus=!1,"checkbox"==e.target.type?n.value=e.target.checked?o:"":"radio"==e.target.type?n.value=e.target.form[a].value:n.value=o})}).finally(h)},h=function(){u("form-field:change",{element:a,state:n.getState()})},x=function(e){n.set(function(e){e.focus=!0,e.touched=!0})},k=function(e){e({elm:a,state:n.getState()})};d(function(e){if(e.data&&JSON.stringify(e.data)!=JSON.stringify(n.getState().data)){var t=a.querySelector("input, select"),r=t.name,o=t.type,u=t.form,i=t.checked,c=t.value,l=!1,d=void 0;n.set(function(t){d=t.value,t.data=Object.assign({},t.data,e.data),"checkbox"==o?t.value=t.data[r]||(i?c:""):"radio"==o?t.value=u[r].value:t.value=t.data[r]||t.value,t.touched=Boolean(t.value),l=Boolean(t.value&&t.data[r]&&t.value!=d)}),l&&setTimeout(function(e){f("input","[name="+r+"]"),f("change","[name="+r+"]")})}})}Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.model=void 0,t.default=o;var u=a(4),i=n(u),c=a(2),l=a(6);t.model={touched:!1,focus:!1,error:null,isValid:!0,data:{},value:null},t.view=function(e){var t=e.touched?"touched":"",a=e.error?"error":"",n=e.focus?"focus":"",r=e.value&&e.isValid&&e.touched?"valid":"";return Object.assign({},e,{fieldClass:(t+" "+a+" "+n+" "+r).trim()})}},function(e,t,a){var n,r,o;(function(e){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(u,i){"object"==a(t)&&"object"==a(e)?e.exports=i():(r=[],n=i,o="function"==typeof n?n.apply(t,r):n,!(void 0!==o&&(e.exports=o)))}(void 0,function(){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new Promise(function(a,n){var r={};return Object.keys(e).forEach(function(a){var n=e[a];Object.keys(n.rules||{}).forEach(function(o){if(!t[o])return console.warn("[Validation] There is no rule => "+o);var u=t[o]({value:n.value,data:n.rules[o],fields:e});u||(r[a]=r[a]||{},r[a][o]={data:n})})}),Object.keys(r).length?n(r):a(e)})}}])})}).call(t,a(5)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INPUT='input:not([type="checkbox"]):not([type="radio"]),textarea',t.SELECTABLE='input[type="checkbox"],input[type="radio"],select',t.VALIDATE_INPUT='input[data-rules]:not([type="checkbox"]):not([type="radio"]),textarea[data-rules]',t.VALIDATE_SELECTABLE='input[data-rules][type="checkbox"],input[data-rules][type="radio"],select[data-rules]'}])});